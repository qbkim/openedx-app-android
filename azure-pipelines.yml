trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

variables:
  buildDir: '$(Build.SourcesDirectory)'

steps:
- task: UseJava@1
  inputs:
    versionSpec: '17'
    jdkArchitecture: 'x64'

# ‚úÖ Fix the conflicting SDK paths
- script: |
    echo "Unsetting ANDROID_SDK_ROOT to avoid SDK path conflict"
    unset ANDROID_SDK_ROOT
    export ANDROID_HOME=/opt/hostedtoolcache/AndroidSDK
    echo "ANDROID_HOME is set to $ANDROID_HOME"
  displayName: 'Fix Android SDK path'

# üîß Restore Gradle dependencies (optional but common)
- script: ./gradlew dependencies
  workingDirectory: $(buildDir)
  displayName: 'Gradle Dependencies'

# üõ†Ô∏è Build the Android app
- task: Gradle@3
  inputs:
    gradleWrapperFile: '$(buildDir)/gradlew'
    workingDirectory: '$(buildDir)'
    options: '--console=plain --stacktrace'
    tasks: 'assembleDebug'
  displayName: 'Gradle Build'
